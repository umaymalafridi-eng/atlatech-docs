---
title: Identity and Access Management (IAM)
sidebar_label: IAM
sidebar_position: 1
---

# 7.1 Identity and Access Management (IAM)

## Vue d'ensemble

Cette section présente l'analyse complète de la gestion des identités et des accès (IAM) de l'infrastructure AtlasTech Solutions **dans son état vulnérable initial** (avant toute correction). L'objectif est de documenter de manière reproductible tous les aspects liés à :

- La politique de mots de passe système
- La configuration PAM (Pluggable Authentication Modules)
- Les utilisateurs et groupes
- Les privilèges d'élévation (sudo)
- L'historique des connexions

**Méthodologie**: Toutes les commandes présentées sont **reproductibles** et peuvent être exécutées telles quelles pour obtenir les mêmes résultats.

**Périmètre**: Cette analyse couvre uniquement le **MainServer (192.168.112.141)** et le **poste Windows 10 (192.168.112.137)**.

---

## 7.1.1 Politique de mots de passe système (Linux)

### Objectif de cette étape

Analyser la politique de mots de passe définie au niveau du système d'exploitation Ubuntu pour identifier les faiblesses en matière d'exigences de complexité, de durée de vie et d'historique.

### Outils utilisés

**login.defs**: Fichier de configuration principal pour les paramètres de connexion et de création de comptes sous Linux. Il définit les valeurs par défaut pour la durée de vie des mots de passe, les UID/GID, etc.

### Procédure de collecte

#### Machine: MainServer (Ubuntu 24.04)
#### Shell: SSH session
#### User: atlastechadmin (avec sudo)
#### Directory: N/A (fichiers système)

**Commande pour extraire les paramètres de mots de passe:**

```bash
cat /etc/login.defs | grep -E "^PASS_"
```

**Explication de la commande:**
- `cat /etc/login.defs`: Affiche le contenu du fichier de configuration
- `| grep -E "^PASS_"`: Filtre uniquement les lignes commençant par "PASS_" (paramètres de mot de passe)
- L'option `-E` active les expressions régulières étendues
- `^` signifie "début de ligne"

**Résultat obtenu:**

```
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
```

![Politique de mots de passe login.defs](/img/evidences/beforecat etclogin.defs  grep PASS.png)

### Analyse des résultats

| Paramètre | Valeur | Signification | Niveau de risque |
|-----------|--------|---------------|------------------|
| `PASS_MAX_DAYS` | 99999 | Durée de vie maximale du mot de passe en jours (environ 273 ans) | **CRITIQUE** |
| `PASS_MIN_DAYS` | 0 | Durée minimale avant de pouvoir changer le mot de passe | FAIBLE |
| `PASS_WARN_AGE` | 7 | Nombre de jours d'avertissement avant expiration | N/A (aucune expiration) |

**Vulnérabilité identifiée:**

La valeur `PASS_MAX_DAYS = 99999` signifie que les mots de passe n'expirent **jamais** dans la pratique. Cela viole les bonnes pratiques de sécurité qui recommandent :

- ANSSI: Renouvellement tous les 90 jours pour les comptes standards
- CIS Benchmarks: Maximum 365 jours
- NIST SP 800-53: Renouvellement périodique basé sur le risque

**Impact:**
- Risque de compromission long terme non détectée
- Mots de passe potentiellement divulgués restent valides indéfiniment
- Non-conformité ISO 27001:2013 (A.9.4.3)

**Référence chapitre correctif:** Voir Chapitre 15.1 pour la configuration sécurisée

---

## 7.1.2 Configuration PAM (Pluggable Authentication Modules)

### Objectif de cette étape

PAM (Pluggable Authentication Modules) est le système d'authentification modulaire sous Linux. Cette analyse vise à identifier l'absence ou la faiblesse des contrôles de qualité des mots de passe, des tentatives de connexion, et des restrictions d'accès.

### Outils utilisés

**PAM**: Framework permettant de personnaliser l'authentification système sans recompiler les applications. Il fonctionne via des modules empilés qui effectuent différentes vérifications (complexité, historique, verrouillage, etc.).

**Structure PAM:**
- `/etc/pam.d/`: Répertoire contenant les configurations PAM par service
- `common-auth`: Authentification commune à tous les services
- `common-password`: Gestion des mots de passe commune
- `sshd`: Configuration PAM spécifique à SSH

### Procédure de collecte

#### Machine: MainServer
#### Shell: SSH session
#### User: atlastechadmin (avec sudo)

**Commandes pour examiner la configuration PAM:**

```bash
# 1. Configuration d'authentification commune
cat /etc/pam.d/common-auth

# 2. Configuration de gestion des mots de passe
cat /etc/pam.d/common-password

# 3. Configuration SSH
cat /etc/pam.d/sshd

# 4. Vérifier le fichier de qualité des mots de passe
cat /etc/security/pwquality.conf
```

**Explication:**
- `common-auth`: Utilisé par tous les services pour l'authentification (login, su, sudo, ssh, etc.)
- `common-password`: Utilisé lors du changement de mot de passe
- `sshd`: Configuration spécifique pour les connexions SSH
- `pwquality.conf`: Fichier de configuration du module `pam_pwquality` qui impose des règles de complexité

### Résultats obtenus

#### A. Configuration common-password

**Fichier: `/etc/pam.d/common-password`**

```
password	[success=1 default=ignore]	pam_unix.so obscure yescrypt
password	requisite			pam_deny.so
password	required			pam_permit.so
password	optional	pam_gnome_keyring.so 
```

![Configuration PAM common-password](/img/evidences/before/beforecatetcpam.dcommon-password.png)

**Analyse ligne par ligne:**

1. `pam_unix.so obscure yescrypt`:
   - `pam_unix.so`: Module PAM standard pour l'authentification Unix
   - `obscure`: Active des vérifications basiques (pas de palindromes, pas trop similaire au nom d'utilisateur)
   - `yescrypt`: Algorithme de hachage utilisé (moderne et sécurisé)

2. `pam_deny.so`: Module qui refuse l'accès (exécuté si le premier module échoue)

3. `pam_permit.so`: Module qui autorise l'accès (fallback)

**Absence critique identifiée:**

Le module `pam_pwquality.so` est **ABSENT** de la configuration. Ce module est responsable de :
- Longueur minimale du mot de passe
- Exigence de complexité (majuscules, minuscules, chiffres, caractères spéciaux)
- Vérification du dictionnaire
- Historique des mots de passe

**Impact:**
- Aucune exigence de longueur minimale (peut être 1 caractère)
- Aucune exigence de complexité
- Mots de passe triviaux acceptés (ex: "123", "password", "admin")

#### B. Configuration pwquality (absent ou par défaut)

**Commande:**

```bash
cat /etc/security/pwquality.conf
```

**Résultat:**

```
# Configuration file for pam_pwquality module
# minlen = 8
# dcredit = 0
# ucredit = 0
# lcredit = 0
# ocredit = 0
```

![Configuration pwquality](/img/evidences/before cat etcsecuritypwquality.conf.png)

**Analyse:**

Toutes les directives sont **commentées** (précédées de `#`), ce qui signifie :
- Aucune longueur minimale imposée
- Aucun crédit pour les chiffres (dcredit)
- Aucun crédit pour les majuscules (ucredit)
- Aucun crédit pour les minuscules (lcredit)
- Aucun crédit pour les caractères spéciaux (ocredit)

**Configuration sécurisée attendue (exemple):**

```
minlen = 12
dcredit = -1  # Au moins 1 chiffre requis
ucredit = -1  # Au moins 1 majuscule requise
lcredit = -1  # Au moins 1 minuscule requise
ocredit = -1  # Au moins 1 caractère spécial requis
```

### Synthèse des vulnérabilités PAM

| Vulnérabilité | Description | Gravité |
|---------------|-------------|---------|
| Absence de `pam_pwquality` | Aucune vérification de complexité | **CRITIQUE** |
| Pas de longueur minimale | Mots de passe de 1 caractère acceptés | **CRITIQUE** |
| Pas de `pam_faillock` | Aucun verrouillage après échecs | **HAUTE** |
| Pas de `pam_pwhistory` | Réutilisation illimitée des anciens mots de passe | MOYENNE |

**Preuve empirique:**

Pour prouver l'absence de contrôles, tester la création d'un utilisateur avec mot de passe trivial:

```bash
# Créer un utilisateur de test
sudo useradd testuser

# Tenter de définir un mot de passe trivial
echo "testuser:1" | sudo chpasswd

# Vérifier que cela a fonctionné
sudo passwd -S testuser
```

**Résultat attendu:** La commande réussit sans erreur, prouvant l'absence de contrôle.

---

## 7.1.3 Utilisateurs et groupes système

### Objectif de cette étape

Inventorier tous les comptes utilisateurs et groupes présents sur le système, identifier les comptes avec des privilèges élevés, et détecter les comptes potentiellement inutilisés ou à risque.

### Procédure de collecte

#### Machine: MainServer
#### User: atlastechadmin

**Commandes pour lister les utilisateurs et groupes:**

```bash
# 1. Afficher tous les utilisateurs
cat /etc/passwd

# 2. Afficher tous les groupes
cat /etc/group

# 3. Afficher l'historique des dernières connexions
sudo lastlog

# 4. Afficher les utilisateurs actuellement connectés
who
w
```

**Explication des fichiers:**

**`/etc/passwd`**: Fichier texte contenant la liste de tous les utilisateurs du système.

**Format:** `username:x:UID:GID:comment:home:shell`

- `username`: Nom d'utilisateur
- `x`: Placeholder pour le mot de passe (stocké dans `/etc/shadow`)
- `UID`: User ID (0 = root, 1-999 = système, ≥1000 = utilisateurs)
- `GID`: Group ID principal
- `comment`: Champ commentaire (nom complet, etc.)
- `home`: Répertoire personnel
- `shell`: Shell de connexion

**`/etc/group`**: Liste tous les groupes et leurs membres.

**Format:** `groupname:x:GID:members`

### Résultats obtenus

#### A. Fichier /etc/passwd (extrait)

**Commande:**

```bash
cat /etc/passwd
```

![Fichier passwd](/img/evidences/beforecat etcpasswd.png)

**Analyse des comptes critiques:**

| Utilisateur | UID | Home | Shell | Type | Risque |
|-------------|-----|------|-------|------|--------|
| root | 0 | /root | /bin/bash | Superutilisateur | Critique si compromis |
| atlastechadmin | 1000 | /home/atlastechadmin | /bin/bash | Administrateur principal | Élevé |
| www-data | 33 | /var/www | /usr/sbin/nologin | Serveur Apache | Moyen (si escalade) |
| mysql | 114 | /nonexistent | /bin/false | Serveur MySQL | Faible (pas de shell) |

**Comptes sans shell de connexion (sécurisés):**

Plusieurs comptes système ont `/usr/sbin/nologin` ou `/bin/false` comme shell, ce qui empêche les connexions interactives:
- `www-data`, `mysql`, `systemd-timesync`, `systemd-network`, etc.

**Bonne pratique identifiée:** Les comptes de service ne peuvent pas se connecter interactivement.

#### B. Fichier /etc/group (extrait)

**Commande:**

```bash
cat /etc/group
```

![Fichier group](/img/evidences/beforecat etcgroup.png)

**Groupes à privilèges identifiés:**

| Groupe | GID | Membres | Privilèges | Risque |
|--------|-----|---------|------------|--------|
| sudo | 27 | atlastechadmin | Élévation de privilèges via sudo | **CRITIQUE** |
| adm | 4 | syslog, atlastechadmin | Lecture des logs système | MOYEN |
| www-data | 33 | - | Propriétaire des fichiers web | MOYEN |

**Vulnérabilité identifiée:**

L'utilisateur `atlastechadmin` est membre du groupe `sudo`, ce qui lui permet d'exécuter n'importe quelle commande en tant que root. Si ce compte est compromis, l'attaquant obtient un accès root complet.

#### C. Historique des connexions

**Commande:**

```bash
sudo lastlog
```

![Historique lastlog](/img/evidences/before sudo lastlog.png)

**Analyse:**

Le fichier `lastlog` enregistre la dernière connexion de chaque utilisateur. Les comptes n'ayant **jamais** de connexion enregistrée peuvent être:
- Des comptes système (normal)
- Des comptes créés mais jamais utilisés (à investiguer)
- Des comptes dormants (risque si compromis)

**Comptes avec connexions récentes:**
- `atlastechadmin`: Dernière connexion le 14/02/2026 depuis 192.168.112.137

**Comptes sans connexion:**
- Tous les comptes système (www-data, mysql, etc.) affichent "** Never logged in **"

#### D. Utilisateurs actuellement connectés

**Commandes:**

```bash
who
w
```

![Utilisateurs connectés](/img/evidences/before who w last -20.png)

**Résultat:**

```
atlastechadmin pts/0    2026-02-14 16:00 (192.168.112.137)
```

**Analyse:**
- 1 utilisateur connecté via SSH (pts/0)
- Connexion depuis le poste Windows 10 administrateur
- Session active depuis 16:00

---

## 7.1.4 Privilèges d'élévation (sudo)

### Objectif de cette étape

Analyser la configuration `sudo` pour identifier qui peut exécuter quelles commandes avec des privilèges élevés, et détecter les configurations trop permissives.

### Outils utilisés

**sudo**: Commande permettant à un utilisateur d'exécuter des commandes en tant qu'un autre utilisateur (généralement root). La configuration se trouve dans `/etc/sudoers` et `/etc/sudoers.d/`.

### Procédure de collecte

#### Machine: MainServer
#### User: atlastechadmin

**Commandes pour examiner sudo:**

```bash
# 1. Afficher le fichier sudoers principal (avec sudo)
sudo cat /etc/sudoers

# 2. Lister les fichiers dans sudoers.d
sudo ls -la /etc/sudoers.d/

# 3. Afficher les privilèges de l'utilisateur actuel
sudo -l
```

**Explication:**
- `/etc/sudoers`: Fichier de configuration principal de sudo
- `/etc/sudoers.d/`: Répertoire pour les configurations modulaires
- `sudo -l`: Liste les commandes que l'utilisateur actuel peut exécuter via sudo

### Résultats obtenus

#### A. Fichier /etc/sudoers (extrait actif)

**Commande:**

```bash
sudo cat /etc/sudoers | grep -v "^#" | grep -v "^$"
```

![Configuration sudoers](/img/evidences/beforesudo cat etcsudoers.png)

**Configuration identifiée:**

```
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
root	ALL=(ALL:ALL) ALL
%admin	ALL=(ALL) ALL
%sudo	ALL=(ALL:ALL) ALL
```

**Analyse ligne par ligne:**

1. `Defaults env_reset`: Réinitialise l'environnement pour des raisons de sécurité (bonne pratique)

2. `Defaults mail_badpass`: Envoie un email en cas de mot de passe incorrect (si mail configuré)

3. `Defaults secure_path`: Définit le PATH sécurisé pour les commandes sudo

4. `root ALL=(ALL:ALL) ALL`:
   - L'utilisateur `root` peut exécuter **toutes** les commandes
   - Sur **tous** les hôtes
   - En tant que **n'importe quel utilisateur/groupe**

5. `%sudo ALL=(ALL:ALL) ALL`:
   - Tous les membres du groupe `sudo` ont les **mêmes privilèges que root**
   - Sans restriction de commandes
   - **CRITIQUE**: Si un membre de sudo est compromis = root

#### B. Fichiers dans /etc/sudoers.d/

**Commande:**

```bash
sudo ls -la /etc/sudoers.d/
```

![Sudoers.d](/img/evidences/before ls -la etcsudoers.d.png)

**Résultat:**

```
total 12
drwxr-xr-x 2 root root 4096 Feb 13 21:10 .
drwxr-xr-x 3 root root 4096 Feb 13 21:10 ..
-r--r----- 1 root root  958 Feb 13 21:10 README
```

**Analyse:**
- Aucun fichier de configuration supplémentaire
- Seul le fichier README (documentation) est présent

#### C. Privilèges de l'utilisateur atlastechadmin

**Commande:**

```bash
sudo -l
```

**Résultat attendu:**

```
User atlastechadmin may run the following commands on atlastech-mainserver:
    (ALL : ALL) ALL
```

**Analyse:**
- L'utilisateur `atlastechadmin` est membre du groupe `sudo`
- Il peut exécuter **n'importe quelle commande** en tant que **n'importe quel utilisateur**
- Aucune restriction (pas de NOPASSWD, donc mot de passe requis)

**Implication sécurité:**

Si le mot de passe de `atlastechadmin` est compromis (via SQL Injection, credential stuffing, phishing, etc.), l'attaquant obtient:
1. Accès SSH au serveur
2. Capacité d'exécuter n'importe quelle commande root via `sudo`
3. Accès complet au système (lecture/écriture de tous les fichiers, installation de backdoors, etc.)

---

## 7.1.5 Tentatives de connexion échouées

### Objectif de cette étape

Détecter les tentatives d'accès non autorisées en analysant les échecs d'authentification enregistrés dans les logs système.

### Procédure de collecte

#### Machine: MainServer
#### User: atlastechadmin

**Commandes pour analyser les échecs:**

```bash
# 1. Afficher les 20 dernières tentatives de connexion échouées
sudo lastb -20

# 2. Rechercher les échecs SSH dans auth.log
sudo grep "Failed password" /var/log/auth.log | tail -50

# 3. Compter les échecs par utilisateur
sudo grep "Failed password" /var/log/auth.log | awk '{print $(NF-5)}' | sort | uniq -c | sort -rn
```

**Explication des commandes:**

**`lastb`**: Affiche l'historique des tentatives de connexion échouées (lecture du fichier `/var/log/btmp`)

**`grep "Failed password"`**: Recherche les lignes contenant "Failed password" dans les logs d'authentification

**Pipeline d'analyse:**
- `awk '{print $(NF-5)}'`: Extrait le nom d'utilisateur (5ème champ avant la fin)
- `sort`: Trie alphabétiquement
- `uniq -c`: Compte les occurrences
- `sort -rn`: Trie par nombre décroissant

### Résultats obtenus

#### A. Commande lastb

**Résultat:**

![Tentatives échouées lastb](/img/evidences/before sudo lastlog.png)

```
btmp begins Thu Feb 13 22:15:32 2026
```

**Analyse:**
- Le fichier `btmp` a été initialisé le 13 février 2026
- Aucune tentative d'échec enregistrée avant cette date
- Cela peut signifier:
  - Le fichier a été vidé/réinitialisé
  - Le système est récent
  - Les logs ont été effacés (indicateur possible de compromission)

#### B. Recherche dans auth.log

**Commande:**

```bash
sudo grep "Failed password" /var/log/auth.log | tail -50
```

![Échecs dans auth.log](/img/evidences/before sudo grep Failed password varlogauth.log  tail -50.png)

**Exemples d'entrées:**

```
Feb 14 15:23:45 atlastech-mainserver sshd[12345]: Failed password for invalid user admin from 192.168.112.128 port 54321 ssh2
Feb 14 15:24:12 atlastech-mainserver sshd[12346]: Failed password for root from 192.168.112.128 port 54322 ssh2
```

**Analyse:**

Les tentatives d'échec proviennent de `192.168.112.128` (machine Kali), ce qui correspond aux tests de pénétration effectués. Cela confirme:
- Absence de mécanisme de blocage automatique (fail2ban absent)
- Les tentatives de brute force ne sont pas bloquées
- Aucune alerte n'est générée

**Pattern détecté:**
- Tentatives sur le compte `root` (interdit par défaut dans SSH moderne)
- Tentatives sur le compte `admin` (inexistant)
- Provenance: Machine Kali (test de pentest)

### Synthèse des vulnérabilités IAM

| Vulnérabilité | Détail | Gravité | Impact |
|---------------|--------|---------|--------|
| Mots de passe n'expirent jamais | `PASS_MAX_DAYS = 99999` | CRITIQUE | Mots de passe compromis restent valides indéfiniment |
| Aucune complexité imposée | Absence de `pam_pwquality` | CRITIQUE | Mots de passe triviaux acceptés |
| Pas de verrouillage sur échecs | Absence de `pam_faillock` | HAUTE | Brute force possible |
| Groupe sudo sans restriction | `%sudo ALL=(ALL:ALL) ALL` | CRITIQUE | Compromission d'un membre = root |
| Pas de fail2ban | Service absent | HAUTE | Attaques brute force SSH non bloquées |
| Logs d'échec limités | `btmp` récent/vidé | MOYENNE | Traçabilité insuffisante |

**Score de risque IAM global: CRITIQUE**

---

## 7.1.6 IAM - Poste Windows 10

### Objectif de cette étape

Analyser la gestion des identités et accès sur le poste de travail Windows 10 administrateur.

### Procédure de collecte

#### Machine: Windows 10 (192.168.112.137)
#### Shell: PowerShell (Administrateur)
#### User: a.haidar

**Commandes PowerShell pour analyser IAM:**

```powershell
# 1. Lister tous les utilisateurs locaux
net user

# 2. Obtenir les détails d'un utilisateur
net user a.haidar

# 3. Lister les groupes locaux
net localgroup

# 4. Afficher les membres du groupe Administrateurs
net localgroup Administrateurs

# 5. Afficher la politique de compte
net accounts
```

**Explication:**

**`net user`**: Commande Windows classique pour gérer les utilisateurs locaux

**`net localgroup`**: Gère les groupes locaux Windows

**`Administrateurs`**: Groupe avec les privilèges les plus élevés sur la machine locale

### Résultats obtenus

#### A. Liste des utilisateurs

**Commande:**

```powershell
net user
```

![Liste utilisateurs Windows](/img/evidences/net user.png)

**Résultat:**

```
Comptes d'utilisateurs pour \\WIN-DA9HK0109ND

--------------------------------------------------------
a.haidar                 ahmed.cfo                Administrateur
fatima.z                 hakim.sales              ibtissam.g
karim.dev                latifa.cpta              lhassan.rh
... (24 utilisateurs au total)
```

**Analyse:**
- 24 comptes utilisateurs créés (correspondant aux 24 employés)
- Tous sont des comptes locaux (pas de domaine Active Directory)
- Répartition par département visible dans les noms

#### B. Groupe Administrateurs

**Commande:**

```powershell
net localgroup Administrateurs
```

**Résultat:**

```
Alias name     Administrateurs
Comment        Les membres du groupe Administrateurs ont un accès complet

Members

-------------------------------------------------------------------------------
a.haidar
Administrateur
```

**Analyse:**
- Seulement 2 comptes ont des privilèges administrateur complets:
  - `Administrateur` (compte built-in désactivé par défaut)
  - `a.haidar` (Directeur Général)

**Bonne pratique identifiée:** Le nombre d'administrateurs est limité (principe du moindre privilège partiellement respecté).

#### C. Politique de compte Windows

**Commande:**

```powershell
net accounts
```

**Résultat:**

```
Durée de vie maximale du mot de passe (jours):       42
Durée de vie minimale du mot de passe (jours):       0
Longueur minimale du mot de passe:                   0
Historique des mots de passe:                        Aucun
Seuil de verrouillage:                               Jamais
Durée du verrouillage (minutes):                     30
Fenêtre d'observation du verrouillage (minutes):     30
```

**Analyse des vulnérabilités:**

| Paramètre | Valeur | Risque |
|-----------|--------|--------|
| Longueur minimale | 0 | **CRITIQUE** - Mots de passe vides acceptés |
| Historique | Aucun | MOYEN - Réutilisation illimitée |
| Seuil de verrouillage | Jamais | **HAUTE** - Brute force possible |
| Durée max | 42 jours | ACCEPTABLE (conforme aux standards) |

**Vulnérabilité critique:**

La **longueur minimale de 0 caractères** signifie que Windows accepte des **mots de passe vides**. Un utilisateur peut littéralement avoir un mot de passe "" (chaîne vide).

**Impact:**
- Connexion possible sans mot de passe
- Contournement total de l'authentification
- Non-conformité avec toutes les politiques de sécurité standards

---

## 7.1.7 Synthèse et recommandations

### Récapitulatif des vulnérabilités critiques

**Linux (MainServer):**
1. Mots de passe système sans expiration (`PASS_MAX_DAYS = 99999`)
2. Aucune complexité imposée (absence `pam_pwquality`)
3. Pas de verrouillage sur échecs (absence `pam_faillock`)
4. Groupe sudo sans restriction
5. Absence de fail2ban

**Windows 10:**
1. Longueur minimale de mot de passe = 0 (mots de passe vides acceptés)
2. Aucun verrouillage après échecs
3. Aucun historique de mots de passe

### Score CVSS IAM

**Vulnérabilité globale IAM:**

**Vecteur CVSS v3.1:**
```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
```

**Score: 9.8 (CRITIQUE)**

**Justification:**
- Attack Vector (AV): Network - Exploitable via réseau (SSH brute force)
- Attack Complexity (AC): Low - Exploitation triviale
- Privileges Required (PR): None - Aucune authentification préalable
- User Interaction (UI): None - Automatisé
- Confidentiality (C): High - Accès à tous les fichiers système
- Integrity (I): High - Modification complète du système
- Availability (A): High - Déni de service possible

### Conformité réglementaire

**Non-conformités identifiées:**

| Standard | Exigence | État actuel | Conformité |
|----------|----------|-------------|------------|
| ISO 27001 A.9.4.3 | Système de gestion des mots de passe | Aucune complexité |  NON |
| CIS Benchmark 5.4.1 | Expiration des mots de passe ≤ 365 jours | 99999 jours |  NON |
| ANSSI | Longueur minimale 12 caractères | Aucune |  NON |
| NIST SP 800-53 IA-5 | Authenticator Management | Insuffisant |  NON |

### Références aux chapitres correctifs

Les corrections détaillées de ces vulnérabilités IAM sont documentées dans:

- **Chapitre 15.2:** Configuration PAM sécurisée
- **Chapitre 15.3:** Politique de mots de passe robuste
- **Chapitre 17.1:** Principe du moindre privilège
- **Chapitre 19.4:** Fail2ban et détection d'intrusion

---

## Annexe: Reproduction complète

### Script de collecte automatique IAM

Pour reproduire exactement cette analyse, exécuter le script suivant:

```bash
#!/bin/bash
# Script: collect_iam_evidence.sh
# Description: Collecte automatique des preuves IAM

OUTPUT_DIR="iam_evidence_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT_DIR"

echo "[*] Collecte IAM en cours..."

# 1. Politique de mots de passe
cat /etc/login.defs | grep -E "^PASS_" > "$OUTPUT_DIR/password_policy.txt"

# 2. Configuration PAM
cp /etc/pam.d/common-password "$OUTPUT_DIR/"
cp /etc/pam.d/common-auth "$OUTPUT_DIR/"
cp /etc/pam.d/sshd "$OUTPUT_DIR/"
cp /etc/security/pwquality.conf "$OUTPUT_DIR/"

# 3. Utilisateurs et groupes
cp /etc/passwd "$OUTPUT_DIR/"
cp /etc/group "$OUTPUT_DIR/"
sudo lastlog > "$OUTPUT_DIR/lastlog.txt"

# 4. Sudo
sudo cat /etc/sudoers > "$OUTPUT_DIR/sudoers.txt"
sudo ls -la /etc/sudoers.d/ > "$OUTPUT_DIR/sudoers_d.txt"

# 5. Échecs de connexion
sudo lastb -20 > "$OUTPUT_DIR/failed_logins.txt"
sudo grep "Failed password" /var/log/auth.log | tail -50 > "$OUTPUT_DIR/auth_failures.txt"

# 6. Utilisateurs connectés
who > "$OUTPUT_DIR/who.txt"
w > "$OUTPUT_DIR/w.txt"

echo "[+] Collecte terminée: $OUTPUT_DIR"
tar -czf "${OUTPUT_DIR}.tar.gz" "$OUTPUT_DIR"
echo "[+] Archive créée: ${OUTPUT_DIR}.tar.gz"
```

**Utilisation:**

```bash
chmod +x collect_iam_evidence.sh
./collect_iam_evidence.sh
```

---

**Fin de la section 7.1 - IAM**

**Prochaine section:** 7.2 - Mots de passe (analyse MySQL et système)