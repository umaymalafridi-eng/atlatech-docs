---
title: Cryptographie et chiffrement
sidebar_label: Cryptographie
sidebar_position: 4
---

# 7.4 Cryptographie et chiffrement

## Vue d'ensemble

Analyse des mécanismes cryptographiques utilisés (ou absents) dans l'infrastructure.

**État actuel:**
- HTTP uniquement (pas de TLS/SSL)
- SSH actif (chiffrement présent)
- MySQL sans SSL
- Mots de passe non hachés

---

## 7.4.1 HTTPS/TLS - Absence complète

### Machine: MainServer
### Port 443: **FERMÉ**

```bash
ss -tlnp | grep :443
```

**Résultat:** Aucune sortie (port 443 non actif)

**Vérification module SSL Apache:**

```bash
apache2ctl -M | grep ssl
```

**Résultat:**

```
ssl_module (shared)
```

**Analyse:** Module SSL **chargé** mais **non configuré**.

---

## 7.4.2 Certificats SSL système

### Commande:

```bash
ls -la /etc/ssl/certs/ | grep -i atlastech
```

**Résultat:** Aucun certificat pour atlastech.

**Test OpenSSL:**

```bash
# Tenter connexion HTTPS
openssl s_client -connect 192.168.112.141:443
```

**Résultat:**

```
connect: Connection refused
```

**Impact:** Tout le trafic (login, données, cookies) est transmis **en clair** sur le réseau.

---

## 7.4.3 SSH - Algorithmes cryptographiques

### Machine: MainServer
### Commande:

```bash
# Lister les algorithmes de chiffrement supportés
ssh -Q cipher
```

**Résultat (extrait):**

```
3des-cbc                    ⚠️ OBSOLÈTE
aes128-cbc                  ⚠️ MODE CBC FAIBLE
aes256-cbc                  ⚠️ MODE CBC FAIBLE
aes128-ctr                   BON
aes256-ctr                   BON
aes128-gcm@openssh.com       EXCELLENT
aes256-gcm@openssh.com       EXCELLENT
chacha20-poly1305@openssh.com  EXCELLENT
```

**Algorithmes de MAC (Message Authentication Code):**

```bash
ssh -Q mac
```

**Résultat:**

```
hmac-sha1                   ⚠️ FAIBLE (SHA-1)
hmac-sha2-256                BON
hmac-sha2-512                EXCELLENT
```

**Recommandation:** Désactiver 3DES, CBC, SHA-1 dans `/etc/ssh/sshd_config`.

---

## 7.4.4 MySQL - Configuration SSL

### Commande:

```sql
SHOW VARIABLES LIKE '%ssl%';
```

**Résultat:**

```
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| have_ssl      | YES   |
| ssl_ca        |       |  ⚠️ VIDE
| ssl_cert      |       |  ⚠️ VIDE
| ssl_key       |       |  ⚠️ VIDE
+---------------+-------+
```

**Analyse:**
- Support SSL **disponible** (have_ssl = YES)
- Certificats **non configurés**
- Connexions MySQL **non chiffrées**

**Impact:** Communications PHP ↔ MySQL en clair (mais localhost uniquement, donc risque limité).

---

## 7.4.5 Version OpenSSL

### Commande:

```bash
openssl version -a
```

**Résultat:**

```
OpenSSL 3.0.13 30 Jan 2024
built on: Mon Feb 12 10:34:28 2024 UTC
platform: debian-amd64
```

**Analyse:** Version récente et sécurisée (OpenSSL 3.0.x).

**Vulnérabilités connues:** Aucune CVE critique sur cette version.

---

## 7.4.6 Hachage des mots de passe

### État actuel:

| Composant | Algorithme | Sécurité |
|-----------|------------|----------|
| MySQL (app) | **Aucun** (plaintext) |  CRITIQUE |
| Linux (/etc/shadow) | yescrypt |  EXCELLENT |
| Windows (SAM) | NTLM | ⚠️ MOYEN |

**Algorithmes recommandés:**

| Usage | Algorithme | Paramètres |
|-------|------------|------------|
| Mots de passe | **Argon2id** | m=65536, t=3, p=4 |
| Alternative | **bcrypt** | cost=12 |
| Éviter | MD5, SHA-1, SHA-256 (trop rapides) | - |

---

## 7.4.7 Chiffrement des données sensibles

### Données sensibles identifiées:

| Donnée | Stockage actuel | Chiffrement | Recommandation |
|--------|-----------------|-------------|----------------|
| Mots de passe | VARCHAR plaintext |  | Argon2id/bcrypt |
| Salaires | DECIMAL |  | AES-256-GCM |
| CIN | VARCHAR |  | AES-256-GCM |
| Emails | VARCHAR |  | Considérer chiffrement |

**Chiffrement au repos (data-at-rest):**

Aucun chiffrement du filesystem MySQL (InnoDB non chiffré).

**Recommandation:** Activer `innodb_encryption = ON` (MariaDB 10.1+).

---

## 7.4.8 Key Management

**Problème actuel:** Aucune gestion de clés cryptographiques.

**Mots de passe en dur:**
- `config.php`: `password123`
- `admin_backup.php`: `P@ssw0rd123` (root MySQL)

**Recommandation:** Utiliser un **gestionnaire de secrets** (Vault, AWS Secrets Manager, ou fichier .env hors git).

---

## 7.4.9 Synthèse Cryptographie

**Forces:**
- SSH avec algorithmes modernes disponibles
- OpenSSL 3.0.x (récent)
- Linux utilise yescrypt

**Faiblesses critiques:**
- **HTTPS absent** (tout en clair)
- **Mots de passe MySQL en plaintext**
- **Aucun chiffrement data-at-rest**
- **Secrets hardcodés dans le code**

**Score CVSS: 8.6 (HAUTE)**

**Conformité:**
- PCI DSS 3.4 - Chiffrement PAN 
- RGPD Art. 32 - Chiffrement 
- ISO 27001 A.10.1 - Cryptographic controls 

**Priorité 1:** Implémenter HTTPS avec Let's Encrypt (gratuit, automatisé).

---